# Настройка домашнего хостинга для Telegram-бота

Это руководство поможет вам настроить работу вашего Telegram-бота 24/7 на вашем собственном компьютере с использованием домашнего интернет-соединения.

## Настройка macOS

### Автозапуск бота при включении компьютера

1. **Настройка Launch Agent**

   Скопируйте файл `com.user.telebot.plist` в директорию Launch Agents:
   ```bash
   mkdir -p ~/Library/LaunchAgents/
   cp com.user.telebot.plist ~/Library/LaunchAgents/
   ```

2. **Загрузка службы**
   ```bash
   launchctl load ~/Library/LaunchAgents/com.user.telebot.plist
   ```

3. **Проверка статуса**
   ```bash
   launchctl list | grep telebot
   ```

### Управление ботом

#### Ручное управление скриптами

В репозитории есть скрипты для ручного управления ботом:

1. **Запуск бота**
   ```bash
   ./run_bot.sh
   ```

2. **Остановка бота**
   ```bash
   ./stop_bot.sh
   ```

#### Управление через launchctl

```bash
# Запуск бота
launchctl load ~/Library/LaunchAgents/com.user.telebot.plist

# Остановка бота
launchctl unload ~/Library/LaunchAgents/com.user.telebot.plist

# Перезапуск бота
launchctl unload ~/Library/LaunchAgents/com.user.telebot.plist
launchctl load ~/Library/LaunchAgents/com.user.telebot.plist
```

## Настройка компьютера для работы 24/7

Для того чтобы ваш бот работал круглосуточно, необходимо настроить компьютер:

1. **Отключите автоматический переход в спящий режим**
   - Откройте Системные настройки → Энергосбережение
   - Установите "Не выключать экран" и "Не переводить компьютер в режим сна" на "Никогда"

2. **Настройте автоматическое включение после сбоя питания**
   - Откройте Системные настройки → Энергосбережение → Battery Backup
   - Включите опцию "Автоматически перезагружаться при сбое питания" (если доступно)
   - Для более подробной настройки проверьте опции в BIOS/UEFI вашего компьютера

3. **Используйте источник бесперебойного питания (ИБП)**
   - Рекомендуется подключить компьютер к ИБП для защиты от краткосрочных отключений электричества

## Настройка доступа к боту из интернета (опционально)

- Обычно для Telegram-бота не требуется внешний доступ, так как он сам подключается к серверам Telegram
- При необходимости внешнего доступа, вам может потребоваться настроить переадресацию портов на роутере

## Мониторинг работы бота

- Регулярно проверяйте логи на наличие ошибок
- Настройте уведомления о состоянии бота (например, через тот же Telegram)

## Просмотр логов и отладка

Бот сохраняет логи в следующие файлы:

- **Основной лог бота**: `/Users/tumowuh/Desktop/Telebot/bot.log`
- **Вывод службы**: `/Users/tumowuh/Desktop/Telebot/output.log`
- **Ошибки службы**: `/Users/tumowuh/Desktop/Telebot/error.log`

Для просмотра логов используйте:
```bash
cat /Users/tumowuh/Desktop/Telebot/bot.log
cat /Users/tumowuh/Desktop/Telebot/output.log
cat /Users/tumowuh/Desktop/Telebot/error.log
```

## Обновление бота

Когда вы вносите изменения в код бота, необходимо перезапустить службу:

```bash
# Получение обновлений из репозитория
cd /Users/tumowuh/Desktop/Telebot
git pull

# Перезапуск бота
launchctl unload ~/Library/LaunchAgents/com.user.telebot.plist
launchctl load ~/Library/LaunchAgents/com.user.telebot.plist
```

## Устранение неполадок

1. **Бот не запускается автоматически**:
   - Проверьте права доступа к файлам бота: `chmod +x /Users/tumowuh/Desktop/Telebot/doraborka.py`
   - Проверьте наличие файла .env с правильными настройками

2. **Бот запускается, но не работает корректно**:
   - Проверьте логи ошибок: `cat /Users/tumowuh/Desktop/Telebot/error.log`
   - Проверьте, что у Python установлены все необходимые библиотеки

3. **Компьютер переходит в спящий режим**:
   - Откройте Системные настройки -> Энергосбережение
   - Установите "Не выключать экран" и "Не переводить компьютер в режим сна" на "Никогда"

4. **Проблемы с динамическим IP**:
   - При смене вашего IP-адреса могут возникнуть проблемы (если у вас динамический IP)
   - Рассмотрите возможность использования сервиса динамического DNS (DDNS)

5. **Отсутствие необходимых библиотек Python**:
   - Если вы видите ошибку `ModuleNotFoundError: No module named 'имя_модуля'`, установите отсутствующую библиотеку:
   ```bash
   # Активация виртуальной среды
   cd /Users/tumowuh/Desktop/Telebot && source .venv/bin/activate
   
   # Установка необходимых библиотек
   pip install python-telegram-bot  # Основная библиотека для Telegram бота
   pip install better_profanity     # Библиотека для фильтрации нецензурной лексики
   pip install python-dotenv        # Библиотека для работы с .env файлами
   ```

## Преимущества и недостатки домашнего хостинга

### Преимущества:
- Полный контроль над сервером
- Отсутствие ежемесячной платы за хостинг
- Мгновенный доступ к логам и возможность быстрого исправления ошибок

### Недостатки:
- Требует, чтобы компьютер работал 24/7
- Зависит от стабильности вашего интернет-соединения
- Потребляет электроэнергию
- При смене вашего IP-адреса могут возникнуть проблемы (если у вас динамический IP) 